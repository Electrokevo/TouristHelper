cmake_minimum_required(VERSION 3.16)
project(TouristHelper LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

find_package(PkgConfig REQUIRED)
pkg_check_modules(MLPACK REQUIRED mlpack)

find_package(Armadillo REQUIRED)
find_package(OpenMP)

# ====== LIBTORCH (CUDA) ======
set(CMAKE_PREFIX_PATH "/home/davidalexx99/libs/libtorch")
find_package(Torch REQUIRED)

add_executable(TouristHelper
        main.cpp
        Helpers.cpp
        LabelEncoder.cpp
)

target_include_directories(TouristHelper PRIVATE ${MLPACK_INCLUDE_DIRS})
target_compile_options(TouristHelper PRIVATE ${MLPACK_CFLAGS_OTHER})
target_link_directories(TouristHelper PRIVATE ${MLPACK_LIBRARY_DIRS})

target_link_libraries(TouristHelper
        PRIVATE
        ${MLPACK_LIBRARIES}
        armadillo
        ${TORCH_LIBRARIES}
)

target_compile_options(TouristHelper PRIVATE -O3 ${TORCH_CXX_FLAGS})

if(OpenMP_CXX_FOUND)
    target_link_libraries(TouristHelper PRIVATE OpenMP::OpenMP_CXX)
endif()
